<!DOCTYPE html>
<html>
<head>
<title>Videos</title>
<style>
body{background:#000;color:white;font-family:Arial}
nav{background:#111;padding:15px}
nav a,nav button{color:#ffd000;margin-right:15px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,300px);gap:20px;padding:20px}
iframe{width:100%;height:200px;border-radius:10px}
.card{background:#1a1a1a;padding:10px;border-radius:10px}
button{background:#ffd000;border:none;padding:5px 10px}
</style>
</head>
<body>

<script>
if(!localStorage.getItem("token")) location.href="login.html";
</script>

<nav>
<a href="videos.html">Videos</a>
<a href="shorts.html">Shorts</a>
<a href="posters.html">Posters</a>
<button onclick="logout()">Logout</button>
</nav>

<input id="search" placeholder="Search video..." onkeyup="searchVideo()" style="margin:15px">

<div class="grid" id="videos"></div>

<script>
function logout(){
  localStorage.removeItem("token");
  location.href="login.html";
}

function loadVideos(){
fetch("https://crazed-infinite-backend.onrender.com/videos")
.then(r=>r.json())
.then(d=>{
videos.innerHTML=d.map(v=>`
<div class="card">
<iframe src="${v.url}" onload="view('${v._id}')"></iframe>
<p>${v.title}</p>
<p>üëÅ ${v.views} | ‚ù§Ô∏è ${v.likes}</p>
<button onclick="like('${v._id}')">Like</button>
</div>`).join("");
});
}

function view(id){
fetch("https://crazed-infinite-backend.onrender.com/video/view/"+id,{method:"PUT"});
}

function like(id){
fetch("https://crazed-infinite-backend.onrender.com/video/like/"+id,{method:"PUT"})
.then(()=>loadVideos());
}

function searchVideo(){
const key = search.value;
fetch("https://crazed-infinite-backend.onrender.com/videos/search/"+key)
.then(r=>r.json())
.then(d=>{
videos.innerHTML=d.map(v=>`
<div class="card">
<iframe src="${v.url}"></iframe>
<p>${v.title}</p>
</div>`).join("");
});
}

loadVideos();
</script>

</body>
</html>
